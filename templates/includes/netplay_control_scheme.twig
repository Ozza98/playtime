<div id="modal-control-scheme" class="modal" tabindex="-1">
    <div class="modal-dialog modal-lg modal-fullscreen-lg-down">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Controls</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <div id="netplay-virtual-gamepad-control" class="text-center">
                    <button type="button" id="netplay-virtual-gamepad-toggle" class="btn btn-outline-secondary">Toggle virtual gamepad</button>
                    <hr>
                </div>
                {% include "platform_settings/controls_by_platform.twig" with platform_id=game.Platform player="0" controls=controls hide_emulator_state_controls=true %}
            </div>
            <div class="modal-footer text-end">
                <button type="button" id="netplay-control-scheme-reset" class="btn btn-outline-secondary">Reset changes</button>
                <button type="button" id="netplay-control-scheme-save" class="btn btn-primary" data-bs-dismiss="modal">Save</button>
            </div>
        </div>
    </div>
</div>

{% include "form_platform_settings_controls_modals.twig" %}
<script src="/assets/platform-settings-controls.js"></script>
<script src="/assets/play-control-scheme.js"></script>

<script>
    window.ControlScheme = {
        0: {
            code: "{{ controls.Keyboard.B }}",
            value2: "{{ controls.Gamepad.B }}"
        },
        1: {
            code: "{{ controls.Keyboard.Y }}",
            value2: "{{ controls.Gamepad.Y }}"
        },
        2: {
            code: "{{ controls.Keyboard.Select }}",
            value2: "{{ controls.Gamepad.Select }}"
        },
        3: {
            code: "{{ controls.Keyboard.Start }}",
            value2: "{{ controls.Gamepad.Start }}"
        },
        4: {
            code: "{{ controls.Keyboard.Up }}",
            value2: "{{ controls.Gamepad.Up }}"
        },
        5: {
            code: "{{ controls.Keyboard.Down }}",
            value2: "{{ controls.Gamepad.Down }}"
        },
        6: {
            code: "{{ controls.Keyboard.Left }}",
            value2: "{{ controls.Gamepad.Left }}"
        },
        7: {
            code: "{{ controls.Keyboard.Right }}",
            value2: "{{ controls.Gamepad.Right }}"
        },
        8: {
            code: "{{ controls.Keyboard.A }}",
            value2: "{{ controls.Gamepad.A }}"
        },
        9: {
            code: "{{ controls.Keyboard.X }}",
            value2: "{{ controls.Gamepad.X }}"
        },
        10: {
            code: "{{ controls.Keyboard.L }}",
            value2: "{{ controls.Gamepad.L }}"
        },
        11: {
            code: "{{ controls.Keyboard.R }}",
            value2: "{{ controls.Gamepad.R }}"
        },
        12: {
            code: "{{ controls.Keyboard.L2 }}",
            value2: "{{ controls.Gamepad.L2 }}"
        },
        13: {
            code: "{{ controls.Keyboard.R2 }}",
            value2: "{{ controls.Gamepad.R2 }}"
        },
        14: {
            code: "{{ controls.Keyboard.L3 }}",
            value2: "{{ controls.Gamepad.L3 }}"
        },
        15: {
            code: "{{ controls.Keyboard.R3 }}",
            value2: "{{ controls.Gamepad.R3 }}"
        },
        16: {
            code: "{{ controls.Keyboard.LStickRight }}",
            value2: "{{ controls.Gamepad.LStickRight }}"
        },
        17: {
            code: "{{ controls.Keyboard.LStickLeft }}",
            value2: "{{ controls.Gamepad.LStickLeft }}"
        },
        18: {
            code: "{{ controls.Keyboard.LStickDown }}",
            value2: "{{ controls.Gamepad.LStickDown }}"
        },
        19: {
            code: "{{ controls.Keyboard.LStickUp }}",
            value2: "{{ controls.Gamepad.LStickUp }}"
        },
        20: {
            code: "{{ controls.Keyboard.RStickRight }}",
            value2: "{{ controls.Gamepad.RStickRight }}"
        },
        21: {
            code: "{{ controls.Keyboard.RStickLeft }}",
            value2: "{{ controls.Gamepad.RStickLeft }}"
        },
        22: {
            code: "{{ controls.Keyboard.RStickDown }}",
            value2: "{{ controls.Gamepad.RStickDown }}"
        },
        23: {
            code: "{{ controls.Keyboard.RStickUp }}",
            value2: "{{ controls.Gamepad.RStickUp }}"
        },
    };

    for (let idx in ControlScheme) {
        const control = ControlScheme[idx];
        if (control.code) {
            control.keycode = parseInt(control.code);
            if (isNaN(control.keycode)) {
                control.keycode = undefined;
            }
        }
    }
</script>
